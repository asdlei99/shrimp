<shrimp name="RTGlass" type="function" description="Raytraced glass, with attenuation, based on Larry Gritz&apos;s glass shader" author="rconstruct">
	<input name="Ka" description="Ambient light coefficient" type="float" default="0.01"/>
	<input name="Kd" description="Diffuse light coefficient" type="float" default="0.05"/>
    <input name="Ks" description="Specular light coefficient" type="float" default="0.95"/>
	<input name="Kr" description="Reflection coefficient" type="float" default="0.95"/>
	<input name="Kt" description="Refraction coefficient" type="float" default="0.98"/>
	<input name="ior" description="Refraction index" type="float" default="1.54"/>
	<input name="roughness" description="Specular roughness" type="float" default="0.2"/>
	<input name="sharpness" description="Specular sharpness" type="float" default="0.7"/>
	<input name="basecolor" description="Base color" type="color" default="color( .82, 1, .93 )"/>
	<input name="attencolor" description="Attenuation color" type="color" default="color( 1, .85, .35)"/>
	<input name="krblur" description="Reflection blur" type="float" default="0"/>
	<input name="ktblur" description="Refraction blur" type="float" default="0"/>
	<input name="aexp" description="Attenuation exponent" type="float" default="0.3"/>
	<input name="aamp" description="Attenuation scale" type="float" default="1"/>
	<input name="samples" description="Ray samples" type="float" default="1"/>
	<input name="refrmaxdist" description="Maximum refraction ray distance" type="float" default="1e38"/>
	<input name="reflmaxdist" description="Maximum reflection ray distance" type="float" default="1e38"/>
	<input name="spectype" description="Specular type, glossy or standard specular" storage="uniform" type="string" default="&quot;glossy&quot;"/>
	<input name="rbounces" description="Maximum number of reflection bounces" type="float" default="1"/>
	<input name="sbounces" description="Maximum number of specular bounces" type="float" default="1"/>
	<input name="krefl" description="Reflection blend factor" type="float" default="1"/>
	<input name="krefr" description="Refraction blend factor" type="float" default="1"/>
	<input name="envmap" description="Env map to use, instead of raytracing" type="string" default="&quot;raytrace&quot;"/>
    <input name="NN" description="Normal vector" type="normal" default="normalize(N)"/>
    <input name="IN" description="Eye vector" type="vector" default="normalize(I)"/>
    <output name="Ci" description="Shaded color" type="color"/>
	<output name="Oi" description="Shaded opacity" type="color"/>
	<include>shadingmodels.h</include>
	<code>
		$(Oi) = Os;
#if RENDERER == pixie
        $(Ci) = rtglasspixie( $(Ka), $(Kd), $(Ks), $(Kr), $(Kt), $(ior),
					$(roughness), $(sharpness), $(basecolor), $(attencolor),
					$(krblur), $(ktblur), $(aexp), $(aamp), $(samples),
					$(refrmaxdist), $(reflmaxdist), $(spectype), $(rbounces),
					$(sbounces), $(krefl), $(krefr), $(IN), $(NN),
					$(envmap) );
#else
        $(Ci) = rtglass( $(Ka), $(Kd), $(Ks), $(Kr), $(Kt), $(ior),
					$(roughness), $(sharpness), $(basecolor), $(attencolor),
					$(krblur), $(ktblur), $(aexp), $(aamp), $(samples),
					$(refrmaxdist), $(reflmaxdist), $(spectype), $(rbounces),
					$(sbounces), $(krefl), $(krefr), $(IN), $(NN),
					$(envmap) );
#endif
	</code>
    <usage>Raytraced glass shader, based on Larry Gritz's glass shader, and in Mario Marengo's VEX work and discussion at odforce.net. Uses attenuation, and blending between pure non-attenuated glass and attenuated (with attenuation color) glass. Defaults to primary reflections, and primary specular highlights only, controlled by rbounces and sbounces respectively. Refraction and reflection blur default to 0, ray samples default to 1, so you increase samples to get better antialiasing, or when blur is used. Attenuation is controlled by aexp and aamp variables, the attenuation exponent and scale respectively, while the blend between pure non attenuated glass and attenuated (attencolor colored) glass, is controlled by krefl and krefr, which control the blend of reflections and refractions respectively. Basecolor is the medium color used for the ambient and diffuse contribution, when they're set, while attencolor is the attenuation color. Spectype defaults to "glossy" (Larry Gritz's glossy specular model), any other value will get you specular highlights using the standard specular() call. Maximum ray distance defaults to 1e38, set this to a lower value, otherwise you'll be raytracing everything + the kitchen sink, with the respective performance penalty that kitchen sinks induce in modern processors. Note that you need to set your RIB raytracing options and attributes, and that the surface must be dual sided to have internal reflections.</usage>
</shrimp>
